---
title: "Block signups with spam emails"
---

The e-mail address is often a tell-tale indicator whether someone signs up to your service with good or bad intent. For example, there is often high correlation between spam/junk sign-ups and the use of disposable e-mail domains. In this guide, we'll make use of the following [Signals](/docs/signals-reference#email-intelligence) to reduce spam sign-ups:

* Disposable e-mail. Prevents temporary e-mail addresses.
* [Multiple aliases per e-mail](/changelog/new-signal-multiple-aliases-per-email). Prevents variations of the same e-mail from signing up.
* Invalid e-mail.
* Generated e-mail. Castle scans for patterns of generated e-mails, such as with usernames in sequence.
* Low quality e-mail. Prevents e-mails with signs of randomness or profanities in it
* Optionally you can add another constraint to only allow e.g. 3 signups per IP per hour.

Depending on your risk stance, you may choose to either block these requests outright, or use the Castle verdict to [trigger a CAPTCHA](/docs/using-captcha-with-castle). With a CAPTCHA, you'll make sure to block bots, but will still allow humans to sign up for your service, even when using questionable e-mails. For blocking bots, you may also want to leverage [Castle's bot score](/docs/risk-scoring#the-three-risk-scores), which includes several other factors

#### Step 1\. Find the spam sign-ups

Let's start by filtering out potential spam signups by creating a search for **registration events with any of the above email signals + a bot score > 60**. [Click here to see it ](https://dashboard.castle.io/v2/events?from=2022-09-03%2014:08:44&to=2022-12-02%2015:08:43&list=%5B%5D&nested=%5B%5D&filterGroups=%7B%22groups%22:%5B%7B%22filters%22:%5B%7B%22op%22:%22$in%22,%22value%22:%5B%22disposable%5Femail%5Fdomain%22,%22generated%5Femail%22,%22invalid%5Femail%22,%22low%5Fquality%5Femail%22,%22multiple%5Faliases%5Fper%5Femail%22%5D,%22field%22:%22signals%22,%22disabled%22:false%7D%5D%7D,%7B%22filters%22:%5B%7B%22op%22:%22$range%22,%22value%22:%7B%22gt%22:0.6,%22lt%22:1%7D,%22field%22:%22scores.bot.score%22,%22disabled%22:false%7D%5D%7D,%7B%22filters%22:%5B%7B%22op%22:%22$eq%22,%22value%22:%22$registration%22,%22field%22:%22type%22,%22disabled%22:false%7D%5D%7D%5D,%22op%22:%22and%22%7D&option=3M&cols=signals&bucket=type&tab=events&ct=bar&groups=%5B%7B%22id%22:%22user.id%22,%22group%22:%22user.id%22,%22label%22:%22Users%22,%22cols%22:%5B%7B%22prop%22:%22scores.account%5Fabuse.score%22,%22func%22:%22$max%22,%22label%22:%22Account%20Abuse%20Score%22%7D,%7B%22prop%22:%22scores.account%5Ftakeover.score%22,%22func%22:%22$max%22,%22label%22:%22Account%20Takeover%20Score%22%7D,%7B%22prop%22:%22scores.bot.score%22,%22func%22:%22$max%22,%22label%22:%22Bot%20Score%22%7D,%7B%22prop%22:%22user.id%22,%22func%22:%22$last%22,%22label%22:%22id%22%7D,%7B%22prop%22:%22user.email%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fumail%22%7D,%7B%22prop%22:%22user.name%22,%22func%22:%22$last%22,%22label%22:%22cst%5Funame%22%7D,%7B%22prop%22:%22ip.location.country%5Fcode%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fcountry%22%7D,%7B%22prop%22:%22ip.location.postal%5Fcode%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fpcode%22%7D,%7B%22prop%22:%22ip.location.city%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fcity%22%7D,%7B%22prop%22:%22user.registered%5Fat%22,%22func%22:%22$last%22,%22label%22:%22Registered%20at%22%7D,%7B%22prop%22:%22signals%22,%22func%22:%22$top%5Fk%22,%22label%22:%22Signals%22,%22options%22:%7B%22size%22:20%7D%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$max%22,%22label%22:%22CASTLE%20LAST%20SEEN%22%7D,%7B%22prop%22:%22device.fingerprint%22,%22func%22:%22$count%22,%22label%22:%22Devices%22,%22options%22:%7B%22distinct%22:true%7D%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$min%22,%22label%22:%22CASTLE%20FIRST%20SEEN%22%7D,%7B%22prop%22:%22user.id%22,%22func%22:%22$count%22,%22label%22:%22Events%22%7D%5D,%22sort%22:%7B%22field%22:%22user.id%22,%22func%22:%22$count%22,%22order%22:%22desc%22%7D%7D,%7B%22id%22:%22device.fingerprint%22,%22group%22:%22device.fingerprint%22,%22label%22:%22Devices%22,%22cols%22:%5B%7B%22prop%22:%22scores.account%5Fabuse.score%22,%22func%22:%22$max%22,%22label%22:%22Account%20Abuse%20Score%22%7D,%7B%22prop%22:%22scores.account%5Ftakeover.score%22,%22func%22:%22$max%22,%22label%22:%22Account%20Takeover%20Score%22%7D,%7B%22prop%22:%22scores.bot.score%22,%22func%22:%22$max%22,%22label%22:%22Bot%20Score%22%7D,%7B%22prop%22:%22device.fingerprint%22,%22func%22:%22$last%22,%22label%22:%22id%22%7D,%7B%22prop%22:%22device.software.name%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fsname%22%7D,%7B%22prop%22:%22device.os.name%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fos%22%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$max%22,%22label%22:%22CASTLE%20LAST%20SEEN%22%7D,%7B%22prop%22:%22ip.location.country%5Fcode%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fcountry%22%7D,%7B%22prop%22:%22ip.location.postal%5Fcode%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fpcode%22%7D,%7B%22prop%22:%22ip.location.city%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fcity%22%7D,%7B%22prop%22:%22ip.address%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fip%22%7D,%7B%22prop%22:%22ip.isp%5Fname%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fisp%22%7D,%7B%22prop%22:%22signals%22,%22func%22:%22$top%5Fk%22,%22label%22:%22Signals%22,%22options%22:%7B%22size%22:20%7D%7D,%7B%22prop%22:%22user.id%22,%22func%22:%22$count%22,%22label%22:%22Users%22,%22options%22:%7B%22distinct%22:true%7D%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$min%22,%22label%22:%22CASTLE%20FIRST%20SEEN%22%7D,%7B%22prop%22:%22device.fingerprint%22,%22func%22:%22$count%22,%22label%22:%22Events%22%7D%5D,%22sort%22:%7B%22field%22:%22device.fingerprint%22,%22func%22:%22$count%22,%22order%22:%22desc%22%7D%7D,%7B%22id%22:%22ip.address%22,%22group%22:%22ip.address%22,%22label%22:%22IPs%22,%22cols%22:%5B%7B%22prop%22:%22ip.address%22,%22func%22:%22$last%22,%22label%22:%22id%22%7D,%7B%22prop%22:%22ip.isp%5Fname%22,%22func%22:%22$last%22,%22label%22:%22ISP%22%7D,%7B%22prop%22:%22ip.location.country%5Fcode%22,%22func%22:%22$last%22,%22label%22:%22Location%22%7D,%7B%22prop%22:%22user.id%22,%22func%22:%22$count%22,%22label%22:%22Users%22,%22options%22:%7B%22distinct%22:true%7D%7D,%7B%22prop%22:%22device.fingerprint%22,%22func%22:%22$count%22,%22label%22:%22Devices%22,%22options%22:%7B%22distinct%22:true%7D%7D,%7B%22prop%22:%22ip.address%22,%22func%22:%22$count%22,%22label%22:%22Events%22%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$max%22,%22label%22:%22CASTLE%20LAST%20SEEN%22%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$min%22,%22label%22:%22CASTLE%20FIRST%20SEEN%22%7D,%7B%22prop%22:%22ip.location.city%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fcity%22%7D,%7B%22prop%22:%22ip.location.postal%5Fcode%22,%22func%22:%22$last%22,%22label%22:%22cst%5Fpcode%22%7D%5D,%22sort%22:%7B%22field%22:%22ip.address%22,%22func%22:%22$count%22,%22order%22:%22desc%22%7D%7D,%7B%22id%22:%22ip.location.country%5Fcode%22,%22group%22:%22ip.location.country%5Fcode%22,%22label%22:%22Countries%22,%22cols%22:%5B%7B%22prop%22:%22ip.location.country%5Fcode%22,%22func%22:%22$last%22,%22label%22:%22id%22%7D,%7B%22prop%22:%22user.id%22,%22func%22:%22$count%22,%22label%22:%22Users%22,%22options%22:%7B%22distinct%22:true%7D%7D,%7B%22prop%22:%22device.fingerprint%22,%22func%22:%22$count%22,%22label%22:%22Devices%22,%22options%22:%7B%22distinct%22:true%7D%7D,%7B%22prop%22:%22ip.location.country%5Fcode%22,%22func%22:%22$count%22,%22label%22:%22Events%22%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$max%22,%22label%22:%22CASTLE%20LAST%20SEEN%22%7D,%7B%22prop%22:%22created%5Fat%22,%22func%22:%22$min%22,%22label%22:%22CASTLE%20FIRST%20SEEN%22%7D%5D,%22sort%22:%7B%22field%22:%22ip.location.country%5Fcode%22,%22func%22:%22$count%22,%22order%22:%22desc%22%7D%7D%5D&advancedFilters=%7B%22user.id%22:%7B%22only%5Fshow%5Fauthenticated%22:%7B%22value%22:false%7D,%22apply%5Fto%5Fcontents%22:%7B%22value%22:true%7D%7D,%22device.fingerprint%22:%7B%22only%5Fshow%5Fauthenticated%22:%7B%22value%22:false%7D,%22apply%5Fto%5Fcontents%22:%7B%22value%22:true%7D%7D,%22ip.address%22:%7B%22only%5Fshow%5Fauthenticated%22:%7B%22value%22:false%7D,%22apply%5Fto%5Fcontents%22:%7B%22value%22:true%7D%7D,%22ip.location.country%5Fcode%22:%7B%22only%5Fshow%5Fauthenticated%22:%7B%22value%22:false%7D,%22apply%5Fto%5Fcontents%22:%7B%22value%22:true%7D%7D%7D) for your own data.

![Filter out potential spam signups](/images/8d43aa1-image.png)

Filter out potential spam signups

#### Step 2\. Stop the spam sign-ups

Next, once you're happy with the filters, we'll go ahead and [create a policy](/docs/creating-a-policy#step-1-create-a-new-policy) that will deny any sign up attempts with the filter criteria outlined in the previous step. 

Simply create a new policy by clicking "create a policy" from the Explore view in the previous section

![Create a Policy from the Explore view](/images/263adc5-bild.png)

Create a Policy from the Explore view

Once you've saved the new policy, don't forget to [activate it and potentially re-order](/docs/creating-a-policy#step-3-enable-and-reorder) it to be evaluated before your other policies for registration